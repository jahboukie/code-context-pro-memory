<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CodeContext Memory Pro - AI Memory Revolution</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: #0a0a0a; color: #fff; line-height: 1.6; }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    
    .header { background: linear-gradient(135deg, #1a1a2e, #16213e); padding: 2rem 0; text-align: center; }
    .header h1 { font-size: 3rem; font-weight: 700; margin-bottom: 1rem; background: linear-gradient(135deg, #00f5ff, #ff0080); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .header p { font-size: 1.5rem; opacity: 0.9; }
    
    .pricing { padding: 4rem 0; }
    .pricing-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; margin-top: 3rem; }
    .pricing-card { background: #1a1a1a; border: 2px solid #333; border-radius: 16px; padding: 2rem; position: relative; }
    .pricing-card.featured { border-color: #00f5ff; background: linear-gradient(135deg, #1a1a2e, #16213e); }
    .pricing-card.featured::before { content: 'üî• EARLY ADOPTER'; position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: #00f5ff; color: #000; padding: 4px 16px; border-radius: 20px; font-weight: 600; font-size: 0.8rem; }
    
    .price { font-size: 3rem; font-weight: 700; margin: 1rem 0; }
    .price .currency { font-size: 1.5rem; opacity: 0.7; }
    .price .period { font-size: 1rem; opacity: 0.7; }
    
    .features { list-style: none; margin: 2rem 0; }
    .features li { padding: 0.5rem 0; }
    .features li::before { content: '‚úÖ'; margin-right: 0.5rem; }
    
    .btn { background: linear-gradient(135deg, #00f5ff, #ff0080); color: #fff; border: none; padding: 1rem 2rem; border-radius: 8px; font-size: 1.1rem; font-weight: 600; cursor: pointer; width: 100%; margin-top: 1rem; transition: transform 0.2s; }
    .btn:hover { transform: translateY(-2px); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    
    .stats { text-align: center; margin: 2rem 0; }
    .remaining { font-size: 1.2rem; font-weight: 600; color: #ff0080; }
    
    .success { background: #1a2e1a; border: 2px solid #00ff88; border-radius: 16px; padding: 2rem; text-align: center; margin: 2rem 0; }
    .error { background: #2e1a1a; border: 2px solid #ff0088; border-radius: 16px; padding: 2rem; text-align: center; margin: 2rem 0; }
    
    .loading { text-align: center; padding: 2rem; }
    .spinner { border: 4px solid #333; border-top: 4px solid #00f5ff; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <div class="header">
    <div class="container">
      <h1>üß† CodeContext Memory Pro</h1>
      <p>Stop paying for AI amnesia. Give your AI persistent memory superpowers.</p>
    </div>
  </div>

  <div class="pricing">
    <div class="container">
      <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>Loading pricing...</p>
      </div>

      <div id="pricing-content" style="display: none;">
        <div class="pricing-grid">
          <div id="early-adopter-card" class="pricing-card featured">
            <h3>Early Adopter</h3>
            <div class="price">
              <span class="currency">$</span>99<span class="period">/month</span>
            </div>
            <p><strong>LOCKED-IN FOREVER</strong></p>
            <div class="stats">
              <div class="remaining" id="remaining-count">Loading...</div>
              <small>early adopter licenses remaining</small>
            </div>
            <ul class="features">
              <li>üß† Infinite Persistent Memory</li>
              <li>‚òÅÔ∏è Cloud Sync Across Devices</li>
              <li>üîß VS Code Integration</li>
              <li>üìÅ Multi-Project Support</li>
              <li>üéØ Priority Support</li>
              <li>üíé Founding Member Status</li>
              <li>üîí Price Never Increases</li>
            </ul>
            <button id="early-adopter-btn" class="btn">Get Early Adopter License</button>
          </div>

          <div class="pricing-card">
            <h3>Standard</h3>
            <div class="price">
              <span class="currency">$</span>199<span class="period">/month</span>
            </div>
            <p>Available after early adopters sell out</p>
            <ul class="features">
              <li>üß† Infinite Persistent Memory</li>
              <li>‚òÅÔ∏è Cloud Sync Across Devices</li>
              <li>üîß VS Code Integration</li>
              <li>üìÅ Multi-Project Support</li>
              <li>üéØ Priority Support</li>
            </ul>
            <button id="standard-btn" class="btn" disabled>$199/month (Coming Soon)</button>
          </div>
        </div>
      </div>

      <div id="error-message" class="error" style="display: none;">
        <h3>‚ùå Error</h3>
        <p id="error-text"></p>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = window.location.origin + '/api';
    const stripe = Stripe('pk_test_51RB0ZzELGHd3NbdJjwtjOoYPrM0n2ZMrlMoEIodPQOopWDTxZj71L186iPaRLCEPxvecJllsZhIKcMDIbQcZbisU00M8rgsX5K'); // Your Stripe publishable key

    async function loadPricing() {
      try {
        const response = await fetch(`${API_BASE}/getPricing`);
        const data = await response.json();
        
        document.getElementById('loading').style.display = 'none';
        document.getElementById('pricing-content').style.display = 'block';
        
        // Update early adopter availability
        const remainingElement = document.getElementById('remaining-count');
        const earlyAdopterBtn = document.getElementById('early-adopter-btn');
        const earlyAdopterCard = document.getElementById('early-adopter-card');
        
        if (data.earlyAdopter.available) {
          remainingElement.textContent = data.earlyAdopter.remaining;
          earlyAdopterBtn.onclick = () => purchaseLicense('early_adopter');
        } else {
          remainingElement.textContent = '0';
          earlyAdopterBtn.textContent = 'SOLD OUT';
          earlyAdopterBtn.disabled = true;
          earlyAdopterCard.classList.remove('featured');
          
          // Enable standard pricing
          const standardBtn = document.getElementById('standard-btn');
          standardBtn.textContent = 'Get Standard License';
          standardBtn.disabled = false;
          standardBtn.onclick = () => purchaseLicense('standard');
        }
        
      } catch (error) {
        showError('Failed to load pricing. Please refresh the page.');
      }
    }

    async function purchaseLicense(tier) {
      const email = prompt('Enter your email address:');
      if (!email) return;
      
      if (!email.includes('@')) {
        alert('Please enter a valid email address');
        return;
      }

      try {
        const response = await fetch(`${API_BASE}/createCheckout`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email, tier }),
        });

        const data = await response.json();
        
        if (response.ok) {
          // Redirect to Stripe Checkout
          window.location.href = data.url;
        } else {
          showError(data.error || 'Failed to create checkout session');
        }
      } catch (error) {
        showError('Network error. Please try again.');
      }
    }

    function showError(message) {
      document.getElementById('error-text').textContent = message;
      document.getElementById('error-message').style.display = 'block';
      document.getElementById('loading').style.display = 'none';
    }

    // Load pricing on page load
    loadPricing();
  </script>
</body>
</html>